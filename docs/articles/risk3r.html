<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Example using risk3r â€¢ risk3r</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/paper/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Example using risk3r">
<meta property="og:description" content="risk3r">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">risk3r</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/risk3r.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/feature-selection.html">Feature Selection</a>
    </li>
    <li>
      <a href="../articles/plots.html">plots</a>
    </li>
    <li>
      <a href="../articles/predictive-metrics.html">Predictive Metrics</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="risk3r_files/header-attrs-2.9/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Example using risk3r</h1>
            
      
      
      <div class="hidden name"><code>risk3r.Rmd</code></div>

    </div>

    
    
<div id="packages" class="section level2">
<h2 class="hasAnchor">
<a href="#packages" class="anchor"></a>Packages</h2>
</div>
<div id="r-echofalse-messagefalse-general-librarydplyr-libraryggplot2-librarypatchwork-main-libraryrisk3r-libraryscorecard-descriptive-premodelling-libraryskimr-libraryxray-librarymoments-libraryrsample-modelling-libraryrandomforest-post-modelling-libraryperformance-libraryparameters-librarybroom-ifrequirekunstomverse-libraryextrafont-extrafontloadfontsquiet-true-theme---kunstomversetheme_knst_segoe-theme_setkunstomversetheme_knst_segoe" class="section level1">
<h1 class="hasAnchor">
<a href="#r-echofalse-messagefalse-general-librarydplyr-libraryggplot2-librarypatchwork-main-libraryrisk3r-libraryscorecard-descriptive-premodelling-libraryskimr-libraryxray-librarymoments-libraryrsample-modelling-libraryrandomforest-post-modelling-libraryperformance-libraryparameters-librarybroom-ifrequirekunstomverse-libraryextrafont-extrafontloadfontsquiet-true-theme---kunstomversetheme_knst_segoe-theme_setkunstomversetheme_knst_segoe" class="anchor"></a><code>{r, echo=FALSE, message=FALSE} # # general # library(dplyr) # library(ggplot2) # library(patchwork) #  # # main # library(risk3r) # library(scorecard) #  # # descriptive &amp; premodelling # library(skimr) # library(xray) # library(moments) # library(rsample) #  # # modelling # library(randomForest) #  # # post modelling # library(performance) # library(parameters) # library(broom) #  # if(require(kunstomverse)){ #   library(extrafont) #   extrafont::loadfonts(quiet = TRUE) #   THEME &lt;- kunstomverse::theme_knst_segoe #   theme_set(kunstomverse::theme_knst_segoe()) # } #  #</code>
</h1>
</div>
<div id="section" class="section level1">
<h1></h1>
</div>
<div id="parameters" class="section level1">
<h1 class="hasAnchor">
<a href="#parameters" class="anchor"></a>## Parameters</h1>
</div>
<div id="section-1" class="section level1">
<h1></h1>
</div>
<div id="r-parameters---list-seed-12345-p_train-0-7-p_concentration--95-iv_min-0-02-weak-count_distr_limit-0-05-correlation_limit-0-5-points0-600-pdo-20-odds0-150" class="section level1">
<h1 class="hasAnchor">
<a href="#r-parameters---list-seed-12345-p_train-0-7-p_concentration--95-iv_min-0-02-weak-count_distr_limit-0-05-correlation_limit-0-5-points0-600-pdo-20-odds0-150" class="anchor"></a><code>{r} # PARAMETERS &lt;- list( #   SEED = 12345, #   P_TRAIN = 0.7, #   P_CONCENTRATION = .95, #   IV_MIN = 0.02, # WEAK &gt;= #   COUNT_DISTR_LIMIT = 0.05, #   CORRELATION_LIMIT = 0.5, #   POINTS0 = 600, #   PDO     = 20, #   ODDS0   = 1/50 # ) #</code>
</h1>
</div>
<div id="section-2" class="section level1">
<h1></h1>
#
<details></details>
</div>
<div id="section-3" class="section level1">
<h1></h1>
</div>
<div id="r-custom_skim---skim_with-numeric-sfl-median-purrrpartialmedian-na-rm-true-skewness-purrrpartialmomentsskewness-na-rm-true-kurtosis-purrrpartialmomentskurtosis-na-rm-true-count_distr_max-risk3rcount_distr_max-n_unique-skimrn_unique-factor-sfl-hhi-risk3rhhi-hhi_lbl-purrrcomposerisk3rhhi-risk3rhhi_label--dir-forward-count_distr_max-risk3rcount_distr_max-append-true-custom_skimdata-select110" class="section level1">
<h1 class="hasAnchor">
<a href="#r-custom_skim---skim_with-numeric-sfl-median-purrrpartialmedian-na-rm-true-skewness-purrrpartialmomentsskewness-na-rm-true-kurtosis-purrrpartialmomentskurtosis-na-rm-true-count_distr_max-risk3rcount_distr_max-n_unique-skimrn_unique-factor-sfl-hhi-risk3rhhi-hhi_lbl-purrrcomposerisk3rhhi-risk3rhhi_label--dir-forward-count_distr_max-risk3rcount_distr_max-append-true-custom_skimdata-select110" class="anchor"></a><code>{r} # custom_skim &lt;- skim_with( #   numeric = sfl( #     median = purrr::partial(median, na.rm = TRUE), #     skewness = purrr::partial(moments::skewness, na.rm = TRUE), #     kurtosis = purrr::partial(moments::kurtosis, na.rm = TRUE), #     count_distr_max = risk3r::count_distr_max, #     n_unique = skimr::n_unique #     ), #   factor = sfl( #     hhi = risk3r::hhi, #     hhi_lbl = purrr::compose(risk3r::hhi, risk3r::hhi_label, .dir = "forward"), #     count_distr_max = risk3r::count_distr_max #     ), #   append = TRUE #   ) #  # # custom_skim(data %&gt;% select(1:10)) #  #</code>
</h1>
</div>
<div id="section-4" class="section level1">
<h1></h1>
</div>
<div id="section-5" class="section level1">
<h1></h1>
#

</div>
<div id="section-6" class="section level1">
<h1></h1>
</div>
<div id="section-7" class="section level1">
<h1></h1>
</div>
<div id="data" class="section level1">
<h1 class="hasAnchor">
<a href="#data" class="anchor"></a>## Data</h1>
</div>
<div id="section-8" class="section level1">
<h1></h1>
</div>
<div id="r-option---3-ifoption-1-data---readrdshereheredata-rawcd-rds-data---data-select1300-whereis-character-sample_n100000-data-select110-glimpse-data---data-mutate-bad_good-ifelsebad_good-1-bad-good-bad_good-factorbad_good-levels-cgood-bad-mutateacrosswhereis-character-as-factor-else-if-option-2-data---scorecardgermancredit-as_tibble-renamebad_good-creditability-selectbad_good-everything-mutatebad_good-forcatsfct_relevelbad_good-good-bad-mutateacrosswhereis-character-as-factor-mutateid-row_number--before-1-else-if-option-3-data---risk3rhmeq-renamebad_good-bad-selectbad_good-everything-mutatebad_good-ifelsebad_good-1-bad-good-mutatebad_good-forcatsfct_relevelbad_good-good-bad-mutateacrosswhereis-character-as-factor-mutateid-row_number--before-1-dimdata" class="section level1">
<h1 class="hasAnchor">
<a href="#r-option---3-ifoption-1-data---readrdshereheredata-rawcd-rds-data---data-select1300-whereis-character-sample_n100000-data-select110-glimpse-data---data-mutate-bad_good-ifelsebad_good-1-bad-good-bad_good-factorbad_good-levels-cgood-bad-mutateacrosswhereis-character-as-factor-else-if-option-2-data---scorecardgermancredit-as_tibble-renamebad_good-creditability-selectbad_good-everything-mutatebad_good-forcatsfct_relevelbad_good-good-bad-mutateacrosswhereis-character-as-factor-mutateid-row_number--before-1-else-if-option-3-data---risk3rhmeq-renamebad_good-bad-selectbad_good-everything-mutatebad_good-ifelsebad_good-1-bad-good-mutatebad_good-forcatsfct_relevelbad_good-good-bad-mutateacrosswhereis-character-as-factor-mutateid-row_number--before-1-dimdata" class="anchor"></a><code>{r} # OPTION &lt;- 3 # if(OPTION == 1) { # data &lt;- readRDS(here::here("data-raw/cd.rds")) #  # data &lt;- data %&gt;% #   # select(1:300, where(is.character)) %&gt;% #   sample_n(100000) #  # data %&gt;%  #   select(1:10) %&gt;%  #   glimpse() #  # data &lt;- data %&gt;%  #   mutate( #     bad_good = ifelse(bad_good == 1, "bad", "good"), #     bad_good = factor(bad_good, levels = c("good", "bad")) #     ) %&gt;%  #   mutate(across(where(is.character), as.factor)) #    # } else if (OPTION == 2) { #    #   data &lt;- scorecard::germancredit %&gt;%  #     as_tibble() %&gt;%  #     rename(bad_good = creditability) %&gt;%  #     select(bad_good, everything()) %&gt;%  #     mutate(bad_good = forcats::fct_relevel(bad_good, "good", "bad"))  %&gt;%  #     mutate(across(where(is.character), as.factor)) %&gt;%  #     mutate(id = row_number(), .before = 1) #    # } else if (OPTION == 3) { #    #   data &lt;- risk3r::hmeq %&gt;%  #     rename(bad_good = bad) %&gt;%  #     select(bad_good, everything()) %&gt;%  #     mutate(bad_good = ifelse(bad_good == 1, "bad", "good")) %&gt;%  #     mutate(bad_good = forcats::fct_relevel(bad_good, "good", "bad"))  %&gt;%  #     mutate(across(where(is.character), as.factor)) %&gt;%  #     mutate(id = row_number(), .before = 1) #    # } #  # dim(data) #</code>
</h1>
</div>
<div id="section-9" class="section level1">
<h1></h1>
</div>
<div id="univariate-analysis" class="section level1">
<h1 class="hasAnchor">
<a href="#univariate-analysis" class="anchor"></a>## Univariate analysis</h1>
</div>
<div id="section-10" class="section level1">
<h1></h1>
</div>
<div id="r-describe---custom_skimdata-use-as-list-to-export-skimr-risk3ras-list-skim_df-writexlwrite_xlsxas-listdescribe-hereheredata-rawdescribe-xlsx" class="section level1">
<h1 class="hasAnchor">
<a href="#r-describe---custom_skimdata-use-as-list-to-export-skimr-risk3ras-list-skim_df-writexlwrite_xlsxas-listdescribe-hereheredata-rawdescribe-xlsx" class="anchor"></a><code>{r} # describe &lt;- custom_skim(data) #  # # use as.list to export skimr (risk3r:::as.list.skim_df) # # writexl::write_xlsx(as.list(describe), here::here("data-raw/describe.xlsx")) #</code>
</h1>
</div>
<div id="section-11" class="section level1">
<h1></h1>
</div>
<div id="remove-variables-with-0-variance-and-near-0-variance-" class="section level1">
<h1 class="hasAnchor">
<a href="#remove-variables-with-0-variance-and-near-0-variance-" class="anchor"></a>Remove variables with 0 variance and near 0 variance.</h1>
</div>
<div id="section-12" class="section level1">
<h1></h1>
</div>
<div id="r-describe_min---skimrpartitiondescribe-purrrmap_dfselect-variable-skim_variable-n_unique-count_distr_max-tibbleas_tibble-vars_to_remove_unique_value---describe_min-filtern_unique-1-pullvariable-vars_to_remove_near_0_var---describe_min-filtercount_distr_max-parametersp_concentration-pullvariable-vars_to_remove_unique_value-vars_to_remove_near_0_var---setdiffvars_to_remove_near_0_var-vars_to_remove_unique_value" class="section level1">
<h1 class="hasAnchor">
<a href="#r-describe_min---skimrpartitiondescribe-purrrmap_dfselect-variable-skim_variable-n_unique-count_distr_max-tibbleas_tibble-vars_to_remove_unique_value---describe_min-filtern_unique-1-pullvariable-vars_to_remove_near_0_var---describe_min-filtercount_distr_max-parametersp_concentration-pullvariable-vars_to_remove_unique_value-vars_to_remove_near_0_var---setdiffvars_to_remove_near_0_var-vars_to_remove_unique_value" class="anchor"></a><code>{r} # describe_min &lt;- skimr::partition(describe) %&gt;%  #   purrr::map_df(select, variable = skim_variable, n_unique, count_distr_max) %&gt;%  #   tibble::as_tibble() #  # vars_to_remove_unique_value &lt;- describe_min %&gt;%  #   filter(n_unique == 1) %&gt;%  #   pull(variable) #  # vars_to_remove_near_0_var &lt;- describe_min %&gt;%  #   filter(count_distr_max &gt;= PARAMETERS$P_CONCENTRATION) %&gt;%  #   pull(variable) #  # vars_to_remove_unique_value # vars_to_remove_near_0_var &lt;- setdiff(vars_to_remove_near_0_var, vars_to_remove_unique_value) #</code>
</h1>
</div>
<div id="section-13" class="section level1">
<h1></h1>
</div>
<div id="or-using-scorecard" class="section level1">
<h1 class="hasAnchor">
<a href="#or-using-scorecard" class="anchor"></a>Or using scorecard:</h1>
</div>
<div id="section-14" class="section level1">
<h1></h1>
</div>
<div id="r-scrd_filter---scorecardvar_filter-data-next-2-parameter-are-needed-even-we-want-only-due-identical_limit-y-bad_good-iv_limit-0-missing_limit-1-identical_limit-parametersp_concentration-return_rm_reason-true-scrd_filterrm-as_tibble-filteris-narm_reason-arrangevariable" class="section level1">
<h1 class="hasAnchor">
<a href="#r-scrd_filter---scorecardvar_filter-data-next-2-parameter-are-needed-even-we-want-only-due-identical_limit-y-bad_good-iv_limit-0-missing_limit-1-identical_limit-parametersp_concentration-return_rm_reason-true-scrd_filterrm-as_tibble-filteris-narm_reason-arrangevariable" class="anchor"></a><code>{r} # scrd_filter &lt;- scorecard::var_filter( #   data,  #   # next 2 parameter are needed even we want only due identical_limit #   y = "bad_good", iv_limit = 0, #   missing_limit = 1, #   identical_limit =  PARAMETERS$P_CONCENTRATION, #   return_rm_reason = TRUE #   ) #  # scrd_filter$rm %&gt;%  #   as_tibble() %&gt;%  #   filter(!is.na(rm_reason)) %&gt;%  #   arrange(variable) #</code>
</h1>
</div>
<div id="section-15" class="section level1">
<h1></h1>
</div>
<div id="anomalies" class="section level1">
<h1 class="hasAnchor">
<a href="#anomalies" class="anchor"></a>### Anomalies</h1>
</div>
<div id="section-16" class="section level1">
<h1></h1>
</div>
<div id="from-httpsgithub-comsicarulxray-" class="section level1">
<h1 class="hasAnchor">
<a href="#from-httpsgithub-comsicarulxray-" class="anchor"></a>From <a href="https://github.com/sicarul/xray" class="uri">https://github.com/sicarul/xray</a>.</h1>
</div>
<div id="section-17" class="section level1">
<h1></h1>
</div>
<div id="r-describe_anomalies---xrayanomaliesdata-as_tibbledescribe_anomaliesvariables-as_tibbledescribe_anomaliesproblem_variables" class="section level1">
<h1 class="hasAnchor">
<a href="#r-describe_anomalies---xrayanomaliesdata-as_tibbledescribe_anomaliesvariables-as_tibbledescribe_anomaliesproblem_variables" class="anchor"></a><code>{r} # describe_anomalies &lt;- xray::anomalies(data) #  # as_tibble(describe_anomalies$variables) #  # as_tibble(describe_anomalies$problem_variables) #</code>
</h1>
</div>
<div id="section-18" class="section level1">
<h1></h1>
</div>
<div id="section-19" class="section level1">
<h1></h1>
</div>
<div id="some-differences-between-result-due-scorecardvar_filter-exclude-nas" class="section level1">
<h1 class="hasAnchor">
<a href="#some-differences-between-result-due-scorecardvar_filter-exclude-nas" class="anchor"></a>Some differences between result due <code>scorecard::var_filter</code> exclude NAs</h1>
</div>
<div id="to-caculate-de-identical-limit-" class="section level1">
<h1 class="hasAnchor">
<a href="#to-caculate-de-identical-limit-" class="anchor"></a>to caculate de identical limit.</h1>
</div>
<div id="section-20" class="section level1">
<h1></h1>
</div>
<div id="removing-variables" class="section level1">
<h1 class="hasAnchor">
<a href="#removing-variables" class="anchor"></a>### Removing variables</h1>
</div>
<div id="section-21" class="section level1">
<h1></h1>
</div>
<div id="surely-we-want-remove-other-variables-like-the-id-operationcustomer-or" class="section level1">
<h1 class="hasAnchor">
<a href="#surely-we-want-remove-other-variables-like-the-id-operationcustomer-or" class="anchor"></a>Surely we want remove other variables like the id operation/customer or</h1>
</div>
<div id="a-temporaltime-variables-" class="section level1">
<h1 class="hasAnchor">
<a href="#a-temporaltime-variables-" class="anchor"></a>a temporal/time variables.</h1>
</div>
<div id="section-22" class="section level1">
<h1></h1>
</div>
<div id="r-vars_to_remove_specials---ctime-id-data---data-select-all_ofvars_to_remove_unique_value-select-all_ofvars_to_remove_near_0_var-select-any_ofvars_to_remove_specials" class="section level1">
<h1 class="hasAnchor">
<a href="#r-vars_to_remove_specials---ctime-id-data---data-select-all_ofvars_to_remove_unique_value-select-all_ofvars_to_remove_near_0_var-select-any_ofvars_to_remove_specials" class="anchor"></a><code>{r} # vars_to_remove_specials &lt;- c("time", "id") #  # data &lt;- data %&gt;%  #   select(-all_of(vars_to_remove_unique_value)) %&gt;%  #   select(-all_of(vars_to_remove_near_0_var)) %&gt;%  #   select(-any_of(vars_to_remove_specials)) #</code>
</h1>
</div>
<div id="section-23" class="section level1">
<h1></h1>
</div>
<div id="split" class="section level1">
<h1 class="hasAnchor">
<a href="#split" class="anchor"></a>## Split</h1>
</div>
<div id="section-24" class="section level1">
<h1></h1>
</div>
<div id="from-httpswww-tidymodels-orgstartrecipesdata-split" class="section level1">
<h1 class="hasAnchor">
<a href="#from-httpswww-tidymodels-orgstartrecipesdata-split" class="anchor"></a>From: <a href="https://www.tidymodels.org/start/recipes/#data-split" class="uri">https://www.tidymodels.org/start/recipes/#data-split</a>
</h1>
</div>
<div id="section-25" class="section level1">
<h1></h1>
</div>
<div id="r-fix-the-random-numbers-by-setting-the-seed-this-enables-the-analysis-to-be-reproducible-when-random-numbers-are-used-set-seedparametersseed-data_split---rsampleinitial_splitdata-prop-parametersp_train-create-data-frames-for-the-two-sets-train_data---trainingdata_split-test_data---testingdata_split" class="section level1">
<h1 class="hasAnchor">
<a href="#r-fix-the-random-numbers-by-setting-the-seed-this-enables-the-analysis-to-be-reproducible-when-random-numbers-are-used-set-seedparametersseed-data_split---rsampleinitial_splitdata-prop-parametersp_train-create-data-frames-for-the-two-sets-train_data---trainingdata_split-test_data---testingdata_split" class="anchor"></a><code>{r} # # Fix the random numbers by setting the seed  # # This enables the analysis to be reproducible when random numbers are used  # set.seed(PARAMETERS$SEED) #  # data_split &lt;- rsample::initial_split(data, prop = PARAMETERS$P_TRAIN) #  # # Create data frames for the two sets: # train_data &lt;- training(data_split) # test_data  &lt;- testing(data_split) #</code>
</h1>
</div>
<div id="section-26" class="section level1">
<h1></h1>
</div>
<div id="we-can-do-check" class="section level1">
<h1 class="hasAnchor">
<a href="#we-can-do-check" class="anchor"></a>We can do check:</h1>
</div>
<div id="section-27" class="section level1">
<h1></h1>
</div>
<div id="r-train_data-countbad_good-mutatensumn-test_data-countbad_good-mutatensumn" class="section level1">
<h1 class="hasAnchor">
<a href="#r-train_data-countbad_good-mutatensumn-test_data-countbad_good-mutatensumn" class="anchor"></a><code>{r} # train_data %&gt;% count(bad_good) %&gt;% mutate(n/sum(n)) # test_data %&gt;% count(bad_good) %&gt;% mutate(n/sum(n)) #</code>
</h1>
</div>
<div id="section-28" class="section level1">
<h1></h1>
</div>
<div id="bivariate-analysis" class="section level1">
<h1 class="hasAnchor">
<a href="#bivariate-analysis" class="anchor"></a>## Bivariate analysis</h1>
</div>
<div id="section-29" class="section level1">
<h1></h1>
</div>
<div id="getting-woes" class="section level1">
<h1 class="hasAnchor">
<a href="#getting-woes" class="anchor"></a>### Getting woes</h1>
</div>
<div id="section-30" class="section level1">
<h1></h1>
</div>
<div id="well-start-with-the-default-method-tree" class="section level1">
<h1 class="hasAnchor">
<a href="#well-start-with-the-default-method-tree" class="anchor"></a>Weâ€™ll start with the default <code>method = "tree"</code>
</h1>
</div>
<div id="section-31" class="section level1">
<h1></h1>
</div>
<div id="r-bins---scorecardwoebin-train_data-y-bad_good-method-tree-count_distr_limit-parameterscount_distr_limit" class="section level1">
<h1 class="hasAnchor">
<a href="#r-bins---scorecardwoebin-train_data-y-bad_good-method-tree-count_distr_limit-parameterscount_distr_limit" class="anchor"></a><code>{r} # bins &lt;- scorecard::woebin( #   train_data,  #   y = "bad_good",  #   method = "tree", #   count_distr_limit = PARAMETERS$COUNT_DISTR_LIMIT #   ) #</code>
</h1>
</div>
<div id="section-32" class="section level1">
<h1></h1>
</div>
<div id="some-sanity-checks" class="section level1">
<h1 class="hasAnchor">
<a href="#some-sanity-checks" class="anchor"></a>Some sanity checks:</h1>
</div>
<div id="section-33" class="section level1">
<h1></h1>
</div>
<div id="r-train_datavariable_with_missing-is-na-table-binsvariable_with_missing" class="section level1">
<h1 class="hasAnchor">
<a href="#r-train_datavariable_with_missing-is-na-table-binsvariable_with_missing" class="anchor"></a><code>{r} # # train_data$variable_with_missing %&gt;% is.na() %&gt;% table() # # bins$variable_with_missing #</code>
</h1>
</div>
<div id="section-34" class="section level1">
<h1></h1>
</div>
<div id="the-risk3r-package-have-woebin_summary-to-get-the-summary-" class="section level1">
<h1 class="hasAnchor">
<a href="#the-risk3r-package-have-woebin_summary-to-get-the-summary-" class="anchor"></a>The risk3r package have <code>woebin_summary</code> to get the summary.</h1>
</div>
<div id="section-35" class="section level1">
<h1></h1>
</div>
<div id="r-dbiv---woebin_summarybins-dbiv-glimpsedbiv" class="section level1">
<h1 class="hasAnchor">
<a href="#r-dbiv---woebin_summarybins-dbiv-glimpsedbiv" class="anchor"></a><code>{r} # dbiv &lt;- woebin_summary(bins) #  # dbiv #  # glimpse(dbiv) #</code>
</h1>
</div>
<div id="section-36" class="section level1">
<h1></h1>
</div>
<div id="note-that-dbiv-object-have-breaks-column-among-other-information-" class="section level1">
<h1 class="hasAnchor">
<a href="#note-that-dbiv-object-have-breaks-column-among-other-information-" class="anchor"></a>Note that <code>dbiv</code> object have <code>breaks</code> column among other information.</h1>
</div>
<div id="section-37" class="section level1">
<h1></h1>
</div>
<div id="in-some-cases-monotonic-woes-are-required-in-continous-variables--with-the" class="section level1">
<h1 class="hasAnchor">
<a href="#in-some-cases-monotonic-woes-are-required-in-continous-variables--with-the" class="anchor"></a>In some cases, monotonic woes are required in continous variables. With the</h1>
</div>
<div id="dbiv-object-we-can-check-what-variables-have-a-high-information-and-no-monotonic" class="section level1">
<h1 class="hasAnchor">
<a href="#dbiv-object-we-can-check-what-variables-have-a-high-information-and-no-monotonic" class="anchor"></a><code>dbiv</code> object we can check what variables have a high information and no monotonic</h1>
</div>
<div id="excluding-the-missing-category-oc-" class="section level1">
<h1 class="hasAnchor">
<a href="#excluding-the-missing-category-oc-" class="anchor"></a>(excluding the missing category oc).</h1>
</div>
<div id="section-38" class="section level1">
<h1></h1>
</div>
<div id="r-dbiv-filter-iv-0-02-a-weak-iv-value-factor-is-numeric-monotone-is-not-monotonic" class="section level1">
<h1 class="hasAnchor">
<a href="#r-dbiv-filter-iv-0-02-a-weak-iv-value-factor-is-numeric-monotone-is-not-monotonic" class="anchor"></a><code>{r} # dbiv %&gt;%  #   filter( #     iv &gt; 0.02,  # A &gt;= weak iv value #     !factor,    # is numeric #     !monotone   # is not monotonic #     ) #</code>
</h1>
</div>
<div id="section-39" class="section level1">
<h1></h1>
</div>
<div id="exploring-finding-the-best-cutsbin" class="section level1">
<h1 class="hasAnchor">
<a href="#exploring-finding-the-best-cutsbin" class="anchor"></a>### Exploring, finding the best cuts/bin</h1>
</div>
<div id="section-40" class="section level1">
<h1></h1>
</div>
<div id="risk3rwoebin2--a-wrapper-around-the-main-scorecardwoebin-function-" class="section level1">
<h1 class="hasAnchor">
<a href="#risk3rwoebin2--a-wrapper-around-the-main-scorecardwoebin-function-" class="anchor"></a><code>risk3r::woebin2</code> -a wrapper around the main <code>scorecard::woebin</code> function-</h1>
</div>
<div id="implement-method-ctree-via-the-partykit-package-well-try-implement-monotonic-binnings-from-mob-package-httpsgithub-comstatcomputemob-" class="section level1">
<h1 class="hasAnchor">
<a href="#implement-method-ctree-via-the-partykit-package-well-try-implement-monotonic-binnings-from-mob-package-httpsgithub-comstatcomputemob-" class="anchor"></a>implement <code>method = "ctree"</code> via the partykit package (weâ€™ll try implement monotonic binnings from mob package <a href="https://github.com/statcompute/mob" class="uri">https://github.com/statcompute/mob</a>).</h1>
</div>
<div id="section-41" class="section level1">
<h1></h1>
</div>
<div id="having-this-we-can-iterate-among-all-available-methods" class="section level1">
<h1 class="hasAnchor">
<a href="#having-this-we-can-iterate-among-all-available-methods" class="anchor"></a>Having this we can iterate among all available methods:</h1>
</div>
<div id="section-42" class="section level1">
<h1></h1>
</div>
<div id="r-messagefalse-binssums---purrrmap_dfctree-ctree-functionm-chimerge-messagem-bins---risk3rwoebin2-train_data-y-bad_good-count_distr_limit-parameterscount_distr_limit-method-m-woebin_summarybins-mutatemethod-m--before-1" class="section level1">
<h1 class="hasAnchor">
<a href="#r-messagefalse-binssums---purrrmap_dfctree-ctree-functionm-chimerge-messagem-bins---risk3rwoebin2-train_data-y-bad_good-count_distr_limit-parameterscount_distr_limit-method-m-woebin_summarybins-mutatemethod-m--before-1" class="anchor"></a><code>{r, message=FALSE} # binssums &lt;- purrr::map_df(c("tree", "ctree"), function(m = "chimerge"){ #  #     message(m) #  #   bins &lt;- risk3r::woebin2( #     train_data, #     y = "bad_good", #     count_distr_limit = PARAMETERS$COUNT_DISTR_LIMIT, #     method = m #     ) #  #    woebin_summary(bins) %&gt;% #      mutate(method = m, .before = 1) #  # }) #</code>
</h1>
</div>
<div id="section-43" class="section level1">
<h1></h1>
</div>
<div id="we-can-check-for-each-variable" class="section level1">
<h1 class="hasAnchor">
<a href="#we-can-check-for-each-variable" class="anchor"></a>We can check, for each variable:</h1>
</div>
<div id="every-method-is-generated-for-every-variable" class="section level1">
<h1 class="hasAnchor">
<a href="#every-method-is-generated-for-every-variable" class="anchor"></a>- Every method is generated for every variable</h1>
</div>
<div id="the-methods-give-same-iv-in-some-variables" class="section level1">
<h1 class="hasAnchor">
<a href="#the-methods-give-same-iv-in-some-variables" class="anchor"></a>- The methods give same IV in some variables</h1>
</div>
<div id="section-44" class="section level1">
<h1></h1>
</div>
<div id="r-binssums-countmethod-binssums-countvariable-iv-countn" class="section level1">
<h1 class="hasAnchor">
<a href="#r-binssums-countmethod-binssums-countvariable-iv-countn" class="anchor"></a><code>{r} # binssums %&gt;% #   count(method) #  # binssums %&gt;% #   count(variable, iv) %&gt;% #   count(n) #</code>
</h1>
</div>
<div id="section-45" class="section level1">
<h1></h1>
</div>
<div id="get-the-best-breaks-in-the-sense-to-maximize-the-iv-the-get-the-breaks" class="section level1">
<h1 class="hasAnchor">
<a href="#get-the-best-breaks-in-the-sense-to-maximize-the-iv-the-get-the-breaks" class="anchor"></a>Get the best breaks in the sense to maximize the IV, the get the breaks</h1>
</div>
<div id="and-finally-uses-scorecardwoebin-" class="section level1">
<h1 class="hasAnchor">
<a href="#and-finally-uses-scorecardwoebin-" class="anchor"></a>and finally uses <code>scorecard::woebin</code>.</h1>
</div>
<div id="section-46" class="section level1">
<h1></h1>
</div>
<div id="r-binbest---binssums-group_byvariable-arrangedesciv-filteriv-maxiv-slice1-binbest-ungroup-countmethod-best_breaks---binbest-selectvariable-breaks-tibbledeframe-bin---scorecardwoebin-train_data-y-bad_good-count_distr_limit-parameterscount_distr_limit-breaks_list-best_breaks-dbiv---woebin_summarybins-dbiv-glimpsedbiv" class="section level1">
<h1 class="hasAnchor">
<a href="#r-binbest---binssums-group_byvariable-arrangedesciv-filteriv-maxiv-slice1-binbest-ungroup-countmethod-best_breaks---binbest-selectvariable-breaks-tibbledeframe-bin---scorecardwoebin-train_data-y-bad_good-count_distr_limit-parameterscount_distr_limit-breaks_list-best_breaks-dbiv---woebin_summarybins-dbiv-glimpsedbiv" class="anchor"></a><code>{r} # binbest &lt;- binssums %&gt;% #   group_by(variable) %&gt;% #   arrange(desc(iv)) %&gt;% #   filter(iv == max(iv)) %&gt;% #   slice(1) #  # binbest %&gt;%  #   ungroup() %&gt;%  #   count(method) #  # best_breaks &lt;- binbest %&gt;% #   select(variable, breaks) %&gt;% #   tibble::deframe() #  # bin &lt;- scorecard::woebin( #   train_data, #   y = "bad_good", #   count_distr_limit = PARAMETERS$COUNT_DISTR_LIMIT, #   breaks_list = best_breaks #   ) #  # dbiv &lt;- woebin_summary(bins) #  # dbiv #  # glimpse(dbiv) #</code>
</h1>
</div>
<div id="section-47" class="section level1">
<h1></h1>
</div>
<div id="apply-woes-to-train-and-test-table-" class="section level1">
<h1 class="hasAnchor">
<a href="#apply-woes-to-train-and-test-table-" class="anchor"></a>Apply woes to train and test table.</h1>
</div>
<div id="section-48" class="section level1">
<h1></h1>
</div>
<div id="finding-variables-with-low-iv" class="section level1">
<h1 class="hasAnchor">
<a href="#finding-variables-with-low-iv" class="anchor"></a>### Finding variables with low IV</h1>
</div>
<div id="section-49" class="section level1">
<h1></h1>
</div>
<div id="just-remove-variables-with-low-predictive-power-" class="section level1">
<h1 class="hasAnchor">
<a href="#just-remove-variables-with-low-predictive-power-" class="anchor"></a>Just remove variables with low predictive power.</h1>
</div>
<div id="section-50" class="section level1">
<h1></h1>
</div>
<div id="r-vars_to_remove_low_iv---dbiv-filteriv-parametersiv_min-pullvariable" class="section level1">
<h1 class="hasAnchor">
<a href="#r-vars_to_remove_low_iv---dbiv-filteriv-parametersiv_min-pullvariable" class="anchor"></a><code>{r} # vars_to_remove_low_iv &lt;- dbiv %&gt;%  #   filter(iv &lt; PARAMETERS$IV_MIN) %&gt;%  #   pull(variable) #</code>
</h1>
</div>
<div id="section-51" class="section level1">
<h1></h1>
</div>
<div id="finding-highly-correlated-woes-variables" class="section level1">
<h1 class="hasAnchor">
<a href="#finding-highly-correlated-woes-variables" class="anchor"></a>### Finding highly correlated woes variables</h1>
</div>
<div id="section-52" class="section level1">
<h1></h1>
</div>
<div id="in-risk3r-we-can-get-a-data-frame-with-correlations-between-woes-and-ivs-to" class="section level1">
<h1 class="hasAnchor">
<a href="#in-risk3r-we-can-get-a-data-frame-with-correlations-between-woes-and-ivs-to" class="anchor"></a>In risk3r we can get a data frame with correlations between woes and IVs to</h1>
</div>
<div id="decide-what-variables-remove-" class="section level1">
<h1 class="hasAnchor">
<a href="#decide-what-variables-remove-" class="anchor"></a>decide what variables remove.</h1>
</div>
<div id="section-53" class="section level1">
<h1></h1>
</div>
<div id="r-false-to-know-check-the-next-steps-below-dcors---woebin_cor_ivtrain_data-bins-upper-false-dcors" class="section level1">
<h1 class="hasAnchor">
<a href="#r-false-to-know-check-the-next-steps-below-dcors---woebin_cor_ivtrain_data-bins-upper-false-dcors" class="anchor"></a><code>{r} # # FALSE to know check the next steps below # dcors &lt;- woebin_cor_iv(train_data, bins, upper = FALSE) # dcors #</code>
</h1>
</div>
<div id="section-54" class="section level1">
<h1></h1>
</div>
<div id="now-we-can-get-the-variables-which-have-high-correlation" class="section level1">
<h1 class="hasAnchor">
<a href="#now-we-can-get-the-variables-which-have-high-correlation" class="anchor"></a>Now, we can get the variables which have high correlation</h1>
</div>
<div id="section-55" class="section level1">
<h1></h1>
</div>
<div id="r-n---lengthbins-vars_to_rm_correlation---dcors-nrowvars_to_rm_correlation-n-n-remove-same-vars-diagonal-vars_to_rm_correlation---vars_to_rm_correlation-filtervar1-var2-nrowvars_to_rm_correlation-n-n-1-keep-upper-matrix-vars_to_rm_correlation---vars_to_rm_correlation-filtervar1_rank-var2_rank-nrowvars_to_rm_correlation-n-n---1-2-remove-variables-which-causes-high-correlations-and-have-lower-iv-respect-the-other-variable-vars_to_rm_correlation---vars_to_rm_correlation-filterabsr-parameterscorrelation_limit-distinctvar2-pull-as-character" class="section level1">
<h1 class="hasAnchor">
<a href="#r-n---lengthbins-vars_to_rm_correlation---dcors-nrowvars_to_rm_correlation-n-n-remove-same-vars-diagonal-vars_to_rm_correlation---vars_to_rm_correlation-filtervar1-var2-nrowvars_to_rm_correlation-n-n-1-keep-upper-matrix-vars_to_rm_correlation---vars_to_rm_correlation-filtervar1_rank-var2_rank-nrowvars_to_rm_correlation-n-n---1-2-remove-variables-which-causes-high-correlations-and-have-lower-iv-respect-the-other-variable-vars_to_rm_correlation---vars_to_rm_correlation-filterabsr-parameterscorrelation_limit-distinctvar2-pull-as-character" class="anchor"></a><code>{r} # n &lt;- length(bins) #  # vars_to_rm_correlation &lt;- dcors  #  # nrow(vars_to_rm_correlation) == n * n  #  # # remove same vars (diagonal) # vars_to_rm_correlation &lt;- vars_to_rm_correlation %&gt;%  #   filter(var1 != var2) #  # nrow(vars_to_rm_correlation) == n * (n-1) #  # # keep upper matrix # vars_to_rm_correlation &lt;- vars_to_rm_correlation %&gt;%  #   filter(var1_rank &lt; var2_rank) #  # nrow(vars_to_rm_correlation) == n * (n - 1) /2 #  # # remove variables which causes high correlations and have lower IV  # # respect the other variable # vars_to_rm_correlation &lt;- vars_to_rm_correlation %&gt;%  #   filter(abs(r) &gt;= PARAMETERS$CORRELATION_LIMIT) %&gt;%  #   distinct(var2) %&gt;%  #   pull() %&gt;%  #   as.character() #</code>
</h1>
</div>
<div id="section-56" class="section level1">
<h1></h1>
</div>
<div id="removing-variables-1" class="section level1">
<h1 class="hasAnchor">
<a href="#removing-variables-1" class="anchor"></a>### Removing variables</h1>
</div>
<div id="section-57" class="section level1">
<h1></h1>
</div>
<div id="r-vars_to_rm_correlation---setdiffvars_to_rm_correlation-vars_to_remove_low_iv-train_data---train_data-select-all_ofvars_to_remove_low_iv-select-all_ofvars_to_rm_correlation" class="section level1">
<h1 class="hasAnchor">
<a href="#r-vars_to_rm_correlation---setdiffvars_to_rm_correlation-vars_to_remove_low_iv-train_data---train_data-select-all_ofvars_to_remove_low_iv-select-all_ofvars_to_rm_correlation" class="anchor"></a><code>{r} # vars_to_rm_correlation &lt;- setdiff(vars_to_rm_correlation, vars_to_remove_low_iv) #  # train_data &lt;- train_data %&gt;%  #   select(-all_of(vars_to_remove_low_iv)) %&gt;%  #   select(-all_of(vars_to_rm_correlation)) #</code>
</h1>
</div>
<div id="section-58" class="section level1">
<h1></h1>
</div>
<div id="applying-woes" class="section level1">
<h1 class="hasAnchor">
<a href="#applying-woes" class="anchor"></a>### Applying woes</h1>
</div>
<div id="section-59" class="section level1">
<h1></h1>
</div>
<div id="just-scorecardwoebin_ply" class="section level1">
<h1 class="hasAnchor">
<a href="#just-scorecardwoebin_ply" class="anchor"></a>Just <code>scorecard::woebin_ply</code> :)</h1>
</div>
<div id="section-60" class="section level1">
<h1></h1>
</div>
<div id="r-class-before-woes-train_data-purrrmap_chrclass-table-train_data---as_tibblescorecardwoebin_plytrain_data-bins-test_data---as_tibblescorecardwoebin_plytest_data-bins-check-all-is-numeric-except-response-variable-train_data-purrrmap_chrclass-table" class="section level1">
<h1 class="hasAnchor">
<a href="#r-class-before-woes-train_data-purrrmap_chrclass-table-train_data---as_tibblescorecardwoebin_plytrain_data-bins-test_data---as_tibblescorecardwoebin_plytest_data-bins-check-all-is-numeric-except-response-variable-train_data-purrrmap_chrclass-table" class="anchor"></a><code>{r} # # class before woes # train_data %&gt;%  #   purrr::map_chr(class) %&gt;%  #   table() #  # train_data &lt;- as_tibble(scorecard::woebin_ply(train_data, bins)) # test_data  &lt;- as_tibble(scorecard::woebin_ply(test_data, bins)) #  # # check all is numeric except response variable # train_data %&gt;%  #   purrr::map_chr(class) %&gt;%  #   table() #</code>
</h1>
</div>
<div id="section-61" class="section level1">
<h1></h1>
</div>
<div id="section-62" class="section level1">
<h1></h1>
</div>
<div id="comparing-models" class="section level1">
<h1 class="hasAnchor">
<a href="#comparing-models" class="anchor"></a>### Comparing models</h1>
</div>
<div id="section-63" class="section level1">
<h1></h1>
</div>
<div id="r-models---list-model_raw-model_fsstep-model_fsglmnet-model_lss_prmt-dmodels---tibblemodel-models-mutate-model_name-craw-stepwise-glmnet--before-1-mutate-terms-purrrmapmodel-broomtidy-n_variables-purrrmap_dblterms-nrow-metrics-purrrmapmodel-model_metrics-metrics_validation-purrrmapmodel-model_metrics-newdata-test_data-dmodels-dmodels-selectmodel_name-terms-tidyrunnestcols-cterms-selectmodel_name-term-estimate-filterterm-intercept-ggplot-geom_tileaesterm-model_name-fill-estimate-themeaxis-text-x-element_textangle-45-hjust-1-dmodels-selectmodel_name-metrics-metrics_validation-tidyrgathersample-value--model_name-tidyrunnestcols-cvalue-tidyrgathermetric-value--model_name--sample-mutatesample-ifelsesample-metrics-train-test-ggplot-geom_pointaesmodel_name-value-color-sample-size-2-facet_wrapvarsmetric-scales-free_y-scale_color_viridis_dbegin-0-3-end-0-8-scale_y_continuouslimits-c0-na-labels-scalespercent" class="section level1">
<h1 class="hasAnchor">
<a href="#r-models---list-model_raw-model_fsstep-model_fsglmnet-model_lss_prmt-dmodels---tibblemodel-models-mutate-model_name-craw-stepwise-glmnet--before-1-mutate-terms-purrrmapmodel-broomtidy-n_variables-purrrmap_dblterms-nrow-metrics-purrrmapmodel-model_metrics-metrics_validation-purrrmapmodel-model_metrics-newdata-test_data-dmodels-dmodels-selectmodel_name-terms-tidyrunnestcols-cterms-selectmodel_name-term-estimate-filterterm-intercept-ggplot-geom_tileaesterm-model_name-fill-estimate-themeaxis-text-x-element_textangle-45-hjust-1-dmodels-selectmodel_name-metrics-metrics_validation-tidyrgathersample-value--model_name-tidyrunnestcols-cvalue-tidyrgathermetric-value--model_name--sample-mutatesample-ifelsesample-metrics-train-test-ggplot-geom_pointaesmodel_name-value-color-sample-size-2-facet_wrapvarsmetric-scales-free_y-scale_color_viridis_dbegin-0-3-end-0-8-scale_y_continuouslimits-c0-na-labels-scalespercent" class="anchor"></a><code>{r} # models &lt;- list( #   model_raw,  #   model_fsstep, #   model_fsglmnet #   # model_lss_prmt #   ) #  # dmodels &lt;- tibble(model = models) %&gt;%  #   mutate( #     model_name = c("raw", "stepwise", "glmnet" #     ), #     .before = 1 #   ) %&gt;%  #   mutate( #     terms              = purrr::map(model, broom::tidy), #     n_variables        = purrr::map_dbl(terms, nrow), #     metrics            = purrr::map(model, model_metrics), #     metrics_validation = purrr::map(model, model_metrics, newdata = test_data) #   ) #  # dmodels #  # dmodels %&gt;%  #   select(model_name, terms) %&gt;%  #   tidyr::unnest(cols = c(terms)) %&gt;%  #   select(model_name, term, estimate) %&gt;%  #   filter(term != "(Intercept)") %&gt;%  #   ggplot() + #   geom_tile(aes(term, model_name, fill = estimate)) + #   theme(axis.text.x = element_text(angle = 45, hjust = 1)) #  # dmodels %&gt;%  #   select(model_name, metrics, metrics_validation) %&gt;%  #   tidyr::gather(sample, value, -model_name) %&gt;%  #   tidyr::unnest(cols = c(value)) %&gt;%  #   tidyr::gather(metric, value, -model_name, -sample) %&gt;%  #   mutate(sample = ifelse(sample == "metrics", "train", "test")) %&gt;%  #   ggplot() + #   geom_point(aes(model_name, value, color = sample), size = 2) + #   facet_wrap(vars(metric), scales = "free_y") + #   scale_color_viridis_d(begin = 0.3, end = 0.8) + #   scale_y_continuous(limits = c(0, NA), labels = scales::percent) #</code>
</h1>
</div>
<div id="section-64" class="section level1">
<h1></h1>
</div>
<div id="partial-preditive-measures" class="section level1">
<h1 class="hasAnchor">
<a href="#partial-preditive-measures" class="anchor"></a>### Partial preditive measures</h1>
</div>
<div id="section-65" class="section level1">
<h1></h1>
</div>
<div id="see-if-we-can-remove-variables-via-inspecting-predictive-measures-" class="section level1">
<h1 class="hasAnchor">
<a href="#see-if-we-can-remove-variables-via-inspecting-predictive-measures-" class="anchor"></a>See if we can remove variables via inspecting predictive measures.</h1>
</div>
<div id="section-66" class="section level1">
<h1></h1>
</div>
<div id="r-models-purrrmapbroomtidy-purrrmapnrow-models-purrrmapbroomtidy-purrrmaphead-model_final---model_fsglmnet-dfmetrics---model_partialsmodel_final-newdata-test_data-dfmetrics-dfmetrics-select-gini--iv-risk3rplot-model_partials-ggplot2themeaxis-text-x-ggplot2element_textangle-45-hjust-1-size-5-ggplot2ylim0-na" class="section level1">
<h1 class="hasAnchor">
<a href="#r-models-purrrmapbroomtidy-purrrmapnrow-models-purrrmapbroomtidy-purrrmaphead-model_final---model_fsglmnet-dfmetrics---model_partialsmodel_final-newdata-test_data-dfmetrics-dfmetrics-select-gini--iv-risk3rplot-model_partials-ggplot2themeaxis-text-x-ggplot2element_textangle-45-hjust-1-size-5-ggplot2ylim0-na" class="anchor"></a><code>{r} # models %&gt;%  #   purrr::map(broom::tidy) %&gt;%  #   purrr::map(nrow) #  # models %&gt;%  #   purrr::map(broom::tidy) %&gt;%  #   purrr::map(head) #  # model_final &lt;- model_fsglmnet #  # dfmetrics &lt;- model_partials(model_final, newdata = test_data) # dfmetrics #  # dfmetrics %&gt;% #   select(-gini, -iv) %&gt;% #   risk3r:::plot.model_partials() + #   ggplot2::theme(axis.text.x = ggplot2::element_text(angle = 45, hjust = 1, size = 5)) + #   ggplot2::ylim(0, NA) #</code>
</h1>
</div>
<div id="section-67" class="section level1">
<h1></h1>
</div>
<div id="performance-package" class="section level1">
<h1 class="hasAnchor">
<a href="#performance-package" class="anchor"></a>### <code>{performance}</code> package</h1>
</div>
<div id="section-68" class="section level1">
<h1></h1>
</div>
<div id="r-check---performancecheck_modelmodel_final-performancecheck_collinearitymodel_final-plot-theme-ggplot2coord_flip-carvifmodel_final" class="section level1">
<h1 class="hasAnchor">
<a href="#r-check---performancecheck_modelmodel_final-performancecheck_collinearitymodel_final-plot-theme-ggplot2coord_flip-carvifmodel_final" class="anchor"></a><code>{r} # check &lt;- performance::check_model(model_final) #  # performance::check_collinearity(model_final) %&gt;%  #   plot() + #   THEME() + #   ggplot2::coord_flip() #  # car::vif(model_final) #</code>
</h1>
</div>
<div id="section-69" class="section level1">
<h1></h1>
</div>
<div id="section-70" class="section level1">
<h1></h1>
</div>
<div id="scorecard" class="section level1">
<h1 class="hasAnchor">
<a href="#scorecard" class="anchor"></a>## Scorecard</h1>
</div>
<div id="section-71" class="section level1">
<h1></h1>
</div>
<div id="r-points0---600-pdo---20-odds0---150-scrcrd---scorecardscorecard-bins-bins-model-model_final-points0-points0-pdo-pdo-odds0-odds0-basepoints_eq0-true-scrcrd2-scrcrd2---scorecardscorecard2-dt-trainingdata_split-y-bad_good-bins-bins-x-stringrstr_removenamescoefmodel_final-1-_woe-points0-points0-pdo-pdo-odds0-odds0-basepoints_eq0-true-scrcrd22" class="section level1">
<h1 class="hasAnchor">
<a href="#r-points0---600-pdo---20-odds0---150-scrcrd---scorecardscorecard-bins-bins-model-model_final-points0-points0-pdo-pdo-odds0-odds0-basepoints_eq0-true-scrcrd2-scrcrd2---scorecardscorecard2-dt-trainingdata_split-y-bad_good-bins-bins-x-stringrstr_removenamescoefmodel_final-1-_woe-points0-points0-pdo-pdo-odds0-odds0-basepoints_eq0-true-scrcrd22" class="anchor"></a><code>{r} # POINTS0   &lt;- 600 # PDO       &lt;- 20 # ODDS0     &lt;- 1/50 #  # scrcrd &lt;- scorecard::scorecard( #   bins = bins, #   model = model_final, #   points0 = POINTS0, #   pdo = PDO, #   odds0 = ODDS0, #   basepoints_eq0 = TRUE #   ) #  # scrcrd[[2]] #  # scrcrd2 &lt;- scorecard::scorecard2( #   dt =  training(data_split), #   y = "bad_good", #   bins = bins, #   x = stringr::str_remove(names(coef(model_final))[-1], "_woe$"), #   points0 = POINTS0, #   pdo = PDO, #   odds0 = ODDS0, #   basepoints_eq0 = TRUE #   ) #  # scrcrd2[[2]] #</code>
</h1>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Joshua Kunst.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.9000.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
